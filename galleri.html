<!DOCTYPE html>
<html lang="da">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galleri</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css?family=Martel:200,300,400,600,700,800,900" rel="stylesheet">
    <style></style>
</head>

<body>
    <div class="main_grid">
        <header>
            <a href="index.html"><img src="img/logo.svg" alt="billede af Galleri Brunsvigs logo" class="logo"></a>
            <div class="menu_mobile">
                <div class="menuklat_burger">
                    <img src="img/menuklat.png" alt="malerklat til burgermenu">
                </div>
                <div class="menubutton">
                    <div class="bar bar1"></div>
                    <div class="bar bar2"></div>
                    <div class="bar bar3"></div>
                </div>
                <nav class="hidden">
                    <div class="menuklat_visning">
                        <img src="img/menuklat.png" alt="malerklat til menuvisning"></div>
                    <ul class="menu_liste">
                        <li> <a href="index.html">FORSIDE</a></li>
                        <li><a href="galleri.html">GALLERI</a></li>
                        <li><a href="kunstneren.html">KUNSTNEREN</a>
                        <li>
                        <li><a href="kontakt.html">KONTAKT</a></li>
                    </ul>
                </nav>
            </div>
        </header>
        <div class="box none"></div>

        <div class="galleri_container">
            <style>
                .galleri_container img {
                    width: 100%;
                }

                .dropdown-container {
                    display: none;
                    padding-left: 8px;
                }

                .active {
                    display: block;
                }

                /*                MODAL visning */
                #modal {
                    width: 100vw;
                    height: 100vh;
                    position: fixed;
                    background-color: rgba(0, 0, 0, 1);
                    opacity: 0;
                    transition: 1s;
                    pointer-events: none;
                    display: grid;
                    grid-template-columns: 1fr auto 1fr;
                    grid-template-rows: auto 1fr;
                }

                #modal-content {
                    margin: 0 10px;
                    grid-column: 2;
                    grid-row: 2;
                    max-width: 490px;
                    height: 70vh;
                    cursor: pointer;
                    background-color: white;
                }

                #modal.show {
                    opacity: 1;
                    transition: 0.5s;
                    pointer-events: all;
                }

                #modal img {
                    width: 100%;
                    height: 60vh;
                    object-fit: scale-down;
                }
            </style>

            <!--            Hvis vi skal have modal til at fylde det hele skal den ligge længere oppe i html koden -->
            <div id="modal">
                <div id="modal-content">
                    <img class="modal-billede" src="" alt="">
                    <h3></h3>
                    <p class="data-size"></p>
                    <p class="data-material"></p>
                    <p class="data-diametri"></p>
                    <p class="data-pris"></p>
                </div>
            </div>

            <div class="sidenav filtrering">
                <div class="menu-item dropdown-btn" data-kategori="Ja">Værker til salg</div>
                <div class="dropdown-container">
                    <div class="sub-item" data-kategori="Maleri">Malerier</div>
                    <div class="sub-item" data-kategori="Tegning">Tegninger</div>
                    <div class="sub-item" data-kategori="Keramik">Keramik</div>
                </div>

                <div class="menu-item dropdown-btn" data-kategori="Nej">Tidligere værker</div>
                <div class="dropdown-container">
                    <div class="sub-item" data-kategori="Maleri">Malerier</div>
                    <div class="sub-item" data-kategori="Tegning">Tegninger</div>
                    <div class="sub-item" data-kategori="Keramik">Keramik</div>
                </div>
            </div>
            <h1>Galleri</h1>
            <h2></h2>
            <div class="data-content"></div>
            <template id="data-template">
                <div class="galleri_content">
                    <img class="image" src="" alt="">
                    <h3></h3>
                    <p class="data-size"></p>
                    <p class="data-material"></p>
                    <p class="data-diametri"></p>
                    <p class="data-pris"></p>
                </div>
            </template>

            <script>
                document.addEventListener("DOMContentLoaded", getJSON);

                let kategoriFilter = "alle";
                let myArt
                let dest = document.querySelector(".data-content");
                let modal = document.querySelector("#modal");
                let dropdown = document.getElementsByClassName("dropdown-btn");
                let i;


                //dropdown filtrerings menu

                //Løber variablen dropdown igennem og afventer at der klikkes på elementet
                for (i = 0; i < dropdown.length; i++) {
                    dropdown[i].addEventListener("click", function() {
                        //der køres en foreach løkke igennem som nulstiller klassen .dropdown-container og dermed sikre at klassen "active" ikke er tilstede
                        document.querySelectorAll(".dropdown-container").forEach(e => {
                            e.classList.remove("active");
                        });
                        //variable til søskeende elementet af det aktive element
                        let dropdownContent = this.nextElementSibling;
                        //tilføjer klassen "active" til variablen dropdownContent
                        dropdownContent.classList.add("active");
                    });
                }


                //filter på top niveau
                document.querySelectorAll(".menu-item").forEach(knap => {
                    knap.addEventListener("click", filtrering)
                });


                function filtrering() {
                    dest.textContent = "";
                    kategoriFilter = this.getAttribute("data-kategori");

                    showArt();
                }

                //filter på under niveau
                document.querySelectorAll(".sub-item").forEach(knap => {
                    knap.addEventListener("click", subfiltrering)
                });


                function subfiltrering() {
                    dest.textContent = "";
                    kategoriFilter = this.getAttribute("data-kategori");

                    showArt();
                }

                //Hent wordpress data og konverter til JSON

                async function getJSON() {

                    let myJSON = await fetch("https://www.lowson.dk/kea/2Sem/02_sem_eksamen_GR_17/wordpress//wp-json/wp/v2/vaerker?per_page=100");
                    myArt = await myJSON.json();

                    showArt();
                }

                //kør en foreach loop igennem og find defineret data og indsæt i template
                function showArt() {
                    let myTemplate = document.querySelector("#data-template");
                    myArt.forEach(artwork => {
                        console.log(kategoriFilter);
                        if (artwork.acf.er_vaerket_til_salg == kategoriFilter || kategoriFilter == "alle") {
                            let klon = myTemplate.cloneNode(true).content;
                            klon.querySelector("img").src = artwork.acf.billede_af_vaerk;
                            klon.querySelector("img").addEventListener("click", () => {
                                visModal(artwork);
                            });
                            if (artwork.acf.vaerkets_navn != "") {
                                klon.querySelector("h3").innerHTML = artwork.acf.vaerkets_navn;
                            } else {
                                klon.querySelector("h3").innerHTML = '"Unavngivet værk"';
                            }

                            if (artwork.acf.bredde != "" || artwork.acf.hojde != "") {
                                klon.querySelector(".data-size").innerHTML = "Bredde x højde: " + artwork.acf.bredde + " x " + artwork.acf.hojde + " cm"
                            }
                            klon.querySelector(".data-material").innerHTML = artwork.acf.materiale;
                            if (artwork.acf.diameter != "") {
                                klon.querySelector(".data-diametri").innerHTML = "Diameter: " + artwork.acf.diameter + " cm";
                            }
                            if (artwork.acf.pris != "") {
                                klon.querySelector(".data-pris").innerHTML = "Pris: " + artwork.acf.pris + " kr.";
                            }
                            dest.appendChild(klon);
                        }
                    })
                }

                function visModal(art) {
                    modal.classList.add("show");
                    modal.querySelector("img").src = art.acf.billede_af_vaerk;
                    modal.querySelector("h3").innerHTML = art.acf.vaerkets_navn;
                    if (art.acf.bredde != "" || art.acf.hojde != "") {
                        modal.querySelector(".data-size").innerHTML = "Bredde x højde: " + art.acf.bredde + " x " + art.acf.hojde + " cm";
                    }
                    modal.querySelector(".data-material").innerHTML = art.acf.materiale;
                    if (art.acf.diameter != "") {
                        modal.querySelector(".data-diametri").innerHTML = "Diameter: " + art.acf.diameter + " cm";
                    }
                    if (art.acf.pris != "") {
                        modal.querySelector(".data-pris").innerHTML = "Pris: " + art.acf.pris + " kr.";
                    }
                    modal.querySelector(".data-material").innerHTML = art.acf.materiale;
                    modal.querySelector("div").addEventListener("click", hideModal);
                }

                function hideModal() {
                    modal.classList.remove("show");
                }
            </script>
        </div>

        <footer>
            <div class="adresse">
                <p class="bold">Adresse:</p>
                <p>Hillerødgade 169</p>
                <p>2400 Kbh. NV.</p>
            </div>
            <div class="streg1"></div>
            <div class="aabningstider">
                <p class="bold">Åbningstider:</p>
                <p>Onsdag 16-18</p>
                <p>Lørdag 11-14</p>
            </div>
            <div class="streg2"></div>
            <div class="facebook">
                <img src="img/facebook_ikon_hvid.png" alt="billede af Facebook ikon"></div>
            <div class="instagram"><img src="img/instagram_ikon_hvid.png" alt="billede af Instagram ikon"></div>

            <div class="telefon">
                <p><a href="tel:+45 53354422">
                        <p>Tlf: 53 35 44 22
                    </a></p>
            </div>
            <div class="email">
                <p>E-mail: markbrunsvig@gmail.com</p>
            </div>

        </footer>
    </div>

    <script></script>
    <script src="script.js"></script>
</body>

</html>
